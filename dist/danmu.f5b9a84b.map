{"version":3,"sources":["src\\util.js","src\\barrage.js","src\\index.js","index.js"],"names":["toRgba","getContentWidth","color","div","document","createElement","style","backgroundColor","body","appendChild","c","window","getComputedStyle","removeChild","value","fontSize","span","position","whiteSpace","font","innerText","textContent","width","clientWidth","Barrage","data","vm","context","time","speed","hasOwnProperty","length","range","opacity","x","ax","y","height","Math","random","moveX","shadowColor","shadowBlur","test","fillStyle","split","fillText","Danmu","canvas","video","options","store","isPause","currentTime","defaults","params","key","getContext","clientHeight","forEach","index","onplay","render","onpause","onseeked","reset","dm","disabled","inited","init","draw","clearRect","requestAnimationFrame","Object","keys","getElementById"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGtBD;;;;;;AAEA,IAAM0B,SAAS5C,SAASuE,cAAT,CAAwB,QAAxB,CAAf;AACA,IAAM1B,QAAQ7C,SAASuE,cAAT,CAAwB,OAAxB,CAAd;;AAEA,IAAMlD,OAAO,CACX;AACEX,SAAO,cADT;AAEEc,QAAM,CAFR,EAEW;AACTC,SAAO;AAHT,CADW,EAMX;AACEf,SAAO,gBADT;AAEEZ,SAAO,MAFT;AAGE0B,QAAM;AAHR,CANW,EAWX;AACEd,SAAO,QADT;AAEEc,QAAM;AAFR,CAXW,EAeX;AACEd,SAAO,SADT;AAEEc,QAAM;AAFR,CAfW,EAmBX;AACEd,SAAO,OADT;AAEEc,QAAM;AAFR,CAnBW,EAuBX;AACEd,SAAO,QADT;AAEEc,QAAM;AAFR,CAvBW,EA2BX;AACEd,SAAO,eADT;AAEEc,QAAM;AAFR,CA3BW,EA+BX;AACEd,SAAO,KADT;AAEEc,QAAM;AAFR,CA/BW,EAmCX;AACEd,SAAO,cADT;AAEEc,QAAM;AAFR,CAnCW,EAuCX;AACEd,SAAO,aADT;AAEEc,QAAM;AAFR,CAvCW,EA2CX;AACEd,SAAO,eADT;AAEEc,QAAM;AAFR,CA3CW,EA+CX;AACEd,SAAO,gBADT;AAEEc,QAAM;AAFR,CA/CW,EAmDX;AACEd,SAAO,gBADT;AAEEc,QAAM;AAFR,CAnDW,EAuDX;AACEd,SAAO,QADT;AAEEc,QAAM,EAFR;AAGE1B,SAAO;AAHT,CAvDW,CAAb;;AA8DA,IAAIgE,KAAK,oBAAUlB,MAAV,EAAkBC,KAAlB,EAAyB;AAChCxB;AADgC,CAAzB,CAAT","file":"danmu.f5b9a84b.map","sourcesContent":["export function toRgba(color) {\r\n  var div = document.createElement('div');\r\n  div.style.backgroundColor = color;\r\n  document.body.appendChild(div);\r\n  var c = window.getComputedStyle(div).backgroundColor;\t\r\n  document.body.removeChild(div);\r\n  return c;\r\n}\r\n\r\nexport function getContentWidth(value,fontSize){\r\n  // 通过创建span来计算内容长度\r\n  let span = document.createElement('span')\r\n  span.style.position = 'absolute';\r\n  span.style.whiteSpace = 'nowrap';\r\n  span.style.font = 'bold ' + fontSize + 'px \"microsoft yahei\", sans-serif';\r\n  span.innerText = value;\r\n  span.textContent = value;\r\n  document.body.appendChild(span);\r\n  let width =  span.clientWidth;\r\n  document.body.removeChild(span);\r\n\r\n  return width\r\n}","import { toRgba, getContentWidth } from './util'\r\n\r\nexport class Barrage {\r\n  constructor(data, vm) {\r\n    this.data = data\r\n    this.vm = vm\r\n    this.context = vm.context\r\n    this.value = data.value\r\n    this.time = data.time\r\n    this.speed = vm.speed\r\n  }\r\n\r\n  init() {\r\n    let speed = this.speed\r\n    if (this.data.hasOwnProperty('speed')) {\r\n      speed = this.data.speed\r\n    }\r\n    if (speed != 0) {\r\n      speed = speed + this.data.value.length / 100\r\n    }\r\n\r\n    let fontSize = this.data.fontSize || this.vm.speed\r\n    let color = this.data.color || this.vm.color\r\n    color = toRgba(color)\r\n\r\n    let range = this.data.range || this.vm.range\r\n    let opacity = this.data.opacity || this.vm.opacity\r\n\r\n    opacity = opacity / 100\r\n\r\n    this.width = getContentWidth(this.value, fontSize)\r\n\r\n    this.x = this.vm.width\r\n    if (speed == 0) {\r\n      this.x = (this.x - this.width) / 2\r\n    }\r\n    this.ax = this.vm.width\r\n\r\n    this.y =\r\n      range[0] * this.vm.height +\r\n      (range[1] - range[0]) * this.vm.height * Math.random()\r\n\r\n    if (this.y > fontSize) {\r\n      this.y = fontSize\r\n    } else if (this.y > height - fontSize) {\r\n      this.y = this.vm.height - fontSize\r\n    }\r\n\r\n    this.moveX = speed\r\n    this.opacity = opacity\r\n    this.color = color\r\n    this.range = range\r\n    this.fontSize = fontSize\r\n  }\r\n\r\n  draw() {\r\n    this.context.shadowColor = `rgba(0,0,0,${this.opacity})`\r\n    this.context.shadowBlur = 2\r\n    this.context.font = `${this.fontSize}px \"microsoft yahei\", sans-serif`\r\n    if (/rgb\\(/.test(this.color)) {\r\n      this.context.fillStyle =\r\n        'rgba(' +\r\n        this.color.split('(')[1].split(')')[0] +\r\n        ',' +\r\n        this.opacity +\r\n        ')'\r\n    } else {\r\n      this.context.fillStyle = this.color\r\n    }\r\n\r\n    this.context.fillText = (this.value, this.x, this.y)\r\n  }\r\n}\r\n","import { Barrage } from './barrage'\r\n\r\nclass Danmu {\r\n  constructor(canvas, video, options) {\r\n    this.canvas = canvas\r\n    this.video = video\r\n    this.options = options\r\n    this.store = {}\r\n    this.isPause = true\r\n    this.time = video.currentTime\r\n    this.fontSize = 28\r\n    this.width = 0\r\n    this.height = 0\r\n\r\n    let defaults = {\r\n      opacity: 100,\r\n      fontSize: 24,\r\n      speed: 2,\r\n      range: [0, 1],\r\n      color: '#fff',\r\n      data: []\r\n    }\r\n\r\n    let params = {}\r\n\r\n    for (let key in defaults) {\r\n      if (options[key]) {\r\n        params[key] = options[key]\r\n      } else {\r\n        params[key] = defaults[key]\r\n      }\r\n\r\n      this[key] = params[key]\r\n    }\r\n\r\n    this.context = this.canvas.getContext('2d')\r\n    this.width = this.canvas.clientWidth\r\n    this.height = this.canvas.clientHeight\r\n\r\n    this.data.forEach((data, index) => {\r\n      this.store[index] = new Barrage(data, this)\r\n    })\r\n\r\n    this.video.onplay = () => {\r\n      this.isPause == false\r\n      this.render()\r\n    }\r\n\r\n    this.video.onpause = () => {\r\n      this.isPause = true\r\n    }\r\n\r\n    this.video.onseeked = () => {\r\n      this.reset()\r\n    }\r\n  }\r\n\r\n  draw() {\r\n    for (let index in this.store) {\r\n      let dm = this.store[index]\r\n      if (dm && !dm.disabled) {\r\n        if (!dm.inited) {\r\n          dm.init()\r\n          dm.inited = true\r\n        }\r\n\r\n        dm.x -= dm.moveX\r\n        if (dm.moveX == 0) {\r\n          dm.ax -= this.speed\r\n        } else {\r\n          dm.ax = dm.x\r\n        }\r\n\r\n        if (dm.ax < -1 * dm.width) {\r\n          dm.x = dm.ax\r\n          dm.disabled = true\r\n        }\r\n\r\n        dm.draw()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    this.time = video.currentTime\r\n\r\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n\r\n    this.draw()\r\n\r\n    if (!this.isPause) {\r\n      requestAnimationFrame(render)\r\n    }\r\n  }\r\n\r\n  add(data) {\r\n    this.store[Object.keys(this.store).length] = new Barrage(data, this)\r\n  }\r\n\r\n  reset() {\r\n    this.time = video.currentTime\r\n\r\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n\r\n    for (var index in this.store) {\r\n      let dm = this.store[index]\r\n      if (dm) {\r\n        dm.disabled = false\r\n        if (this.time < dm.time) {\r\n          dm.inited = null\r\n        } else {\r\n          dm.disabled = true\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default Danmu\r\n","import Danmu from './src/index'\r\n\r\nconst canvas = document.getElementById('canvas')\r\nconst video = document.getElementById('video')\r\n\r\nconst data = [\r\n  {\r\n    value: 'speed设为0为非滚动',\r\n    time: 1, // 单位秒\r\n    speed: 0\r\n  },\r\n  {\r\n    value: 'time控制弹幕时间，单位秒',\r\n    color: 'blue',\r\n    time: 2\r\n  },\r\n  {\r\n    value: '视频共21秒',\r\n    time: 3.2\r\n  },\r\n  {\r\n    value: '视频背景为白色',\r\n    time: 4.5\r\n  },\r\n  {\r\n    value: '视频为录制',\r\n    time: 5.0\r\n  },\r\n  {\r\n    value: '视频内容简单',\r\n    time: 6.3\r\n  },\r\n  {\r\n    value: '是为了让视频尺寸不至于过大',\r\n    time: 7.8\r\n  },\r\n  {\r\n    value: '省流量',\r\n    time: 8.5\r\n  },\r\n  {\r\n    value: '支持弹幕暂停（视频暂停）',\r\n    time: 9\r\n  },\r\n  {\r\n    value: 'add()方法新增弹幕',\r\n    time: 11\r\n  },\r\n  {\r\n    value: 'reset()方法重置弹幕',\r\n    time: 11\r\n  },\r\n  {\r\n    value: '颜色，字号，透明度可全局设置',\r\n    time: 13\r\n  },\r\n  {\r\n    value: '具体交互细节可参考页面源代码',\r\n    time: 14\r\n  },\r\n  {\r\n    value: '内容不错哦！',\r\n    time: 18,\r\n    color: 'yellow'\r\n  }\r\n]\r\n\r\nlet dm = new Danmu(canvas, video, {\r\n  data\r\n})"]}